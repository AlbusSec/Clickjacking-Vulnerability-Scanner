"""
Albus Security
Author: Aniket Tyagi (Founder)
"""

import requests
import argparse
import sys
from colorama import Fore
from urllib3 import disable_warnings
import time


# SSL--Warning

disable_warnings()

print(Fore.LIGHTGREEN_EX + '\t\t\t CLICK-HIJACKING-VULNERABILITY-SCANNER')
print("\t\t\tWELCOME TO ALBUS SECURITY".format(Fore.YELLOW))
print(Fore.LIGHTWHITE_EX + '\t\t\tAuthor: Aniket Tyagi')
print(Fore.CYAN + "Note: ------------------------------------------------------------------------------------",
      Fore.RED + '\n\tI will improve this code again after completed penetration-list project',
      Fore.CYAN + "\n-------------------------------------------------------------------------------------------")

# Argument Controller

if len(sys.argv) > 1:
    pass
else:
    print(Fore.MAGENTA + '\n%s Please use -h for help.' % (sys.argv[0]))
    exit(0)

parser = argparse.ArgumentParser()
parser.add_argument('-F', '--file', help='Provide URL-List')
parser.add_argument('-T', '--timeout', help='Maximum number of seconds to wait while\
                                  requesting a web page (Default: 7)', default=10, type=int)
parser.add_argument('-O','--output', help='Provide name to save your output')

args = parser.parse_args()
Domains = args.file
timer = args.timeout
filer = args.output



# Data Generator

def DataGene(fIlename):
    file_a = open(fIlename, "r")
    data_list: list[str] = []
    [data_list.append(http_head.strip()) for http_head in file_a]
    return data_list


# Main Material

urls_list = DataGene(Domains)
print(Fore.GREEN+"loading......")
time.sleep(2)
print("loading.............")
time.sleep(2)
print("Injected!! Showing output")

# Save your output 

filename1=open(filer,"w")
filename1.write("Your Vulnerable Domain")

# Main Code

for url in urls_list:

    try:

        response = requests.get(url)
        if "X-Frame-Options" not in response.headers:
            print(Fore.GREEN+"\nYour Target Is Vulnerable")
            print(Fore.GREEN+"Vulnerable target url:-\t\t",Fore.WHITE+ url)
            filename1=open(filer ,"a")
            filename1.write("\n"+ url)

        else:
            print(Fore.LIGHTYELLOW_EX + "\nYour Target is not Vulnerable--\t", Fore.WHITE + url)
     
            
    except Exception:
        print(Fore.RED + "\nMake Sure your Target is visible:------", url)
        pass
    
print(Fore.GREEN+"I'll store vulnerable domains list in your entered file")
print(Fore.GREEN+"Thank You!! Happy Hacking")
